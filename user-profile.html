<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>User Profile</title>
  
</head>
<body>
  <h2>User Profile Form</h2>
  <form id="userProfileForm">
  <input type="text" name="full_name" placeholder="Full Name" required />
  <input type="text" name="unit" placeholder="Unit" />
  <input type="text" name="position" placeholder="Position" />
  <input type="number" name="age" placeholder="Age" />
  <select name="gender" required>
    <option value="">Select Gender</option>
    <option value="Male">Male</option>
    <option value="Female">Female</option>
    <option value="Other">Other</option>
  </select>
  <input type="text" name="education_level" placeholder="Education Level" />
  <input type="text" name="marital_status" placeholder="Marital Status" />
  <input type="number" name="years_of_service" placeholder="Years of Service" />
  <input type="number" name="height" placeholder="Height (cm)" />
  <input type="number" name="weight" placeholder="Weight (kg)" />
  <input type="text" name="blood_group" placeholder="Blood Group" />
  <input type="text" name="medical_conditions" placeholder="Medical Conditions (comma separated)" />
  <input type="text" name="allergies" placeholder="Allergies (comma separated)" />
  <button type="submit">Submit</button>
  <p id="message"></p>
</form>

<script src="user-profile.js"></script>


  <script>
    document.getElementById("userProfileForm").addEventListener("submit", async function (e) {
      e.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData);
      data.medical_conditions = data.medical_conditions?.split(",").map(s => s.trim());
      data.allergies = data.allergies?.split(",").map(s => s.trim());

      try {
        const res = await fetch("/api/user-profiles", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        if (res.ok) {
          document.getElementById("message").innerText = "Profile added!";
          this.reset();
        } else {
          document.getElementById("message").innerText = result.error || "Failed.";
        }
      } catch (err) {
        document.getElementById("message").innerText = "Error: " + err.message;
      }
    });
  </script>
</body>
</html>
